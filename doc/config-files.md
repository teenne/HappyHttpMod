# Happy Http configuration files

Happy Http uses two TOML-named configuration files in the Minecraft `config/` directory:

- `happyhttp-common.toml` – standard Forge config created from the common config spec.
- `happyhttp-global-vars.toml` – a properties-style file generated by the mod to define global query parameters.

## `happyhttp-common.toml`

`happyhttp-common.toml` is generated by Forge from the mod's common config spec. It holds the HTTP server binding options used when the server starts up.

### Settings

| Key | Default | Description |
| --- | --- | --- |
| `Http Server Settings.port` | `8080` | TCP port the embedded HTTP server listens on. The value is constrained to 0–999,999 by the config spec. |
| `Http Server Settings.local_adress` | `"192.168.0.1"` | Preferred local IPv4 address to advertise. Leave empty to let the mod auto-detect a non-loopback IPv4 interface. |

### Usage

- The config spec defines the values and default comments for Forge to write into `happyhttp-common.toml`.【F:forge/src/main/java/com/clapter/httpautomator/platform/config/HttpServerConfig.java†L24-L39】
- When the HTTP server starts, it reads `port` to bind the listening socket and uses `local_adress` (or detects one if the value is empty) for the address reported by the mod.【F:common/src/main/java/com/clapter/httpautomator/http/HttpServerImpl.java†L33-L67】

## `happyhttp-global-vars.toml`

`happyhttp-global-vars.toml` is created on first run (if missing) and stores reusable query parameters and redirect behavior for all HTTP Receiver blocks. The file uses a simple `key=value` properties syntax, even though the extension is TOML.

### File creation and format

- On startup the mod writes a commented template that explains how to declare global parameters and includes an example webhook URL. It also seeds a placeholder redirect entry called `global_param_redirect_missing`.【F:forge/src/main/java/com/clapter/httpautomator/platform/config/HttpServerConfig.java†L41-L89】
- The reader expects keys shaped as `global_param.<id>.name`, `global_param.<id>.value`, and `global_param.<id>.redirect_wrong`, where `<id>` is any identifier you choose to group the three parts of a single parameter.【F:forge/src/main/java/com/clapter/httpautomator/platform/config/HttpServerConfig.java†L92-L133】
- An optional `global_param_redirect_missing` entry defines where to redirect when an HTTP Receiver request arrives with no parameters at all.【F:forge/src/main/java/com/clapter/httpautomator/platform/config/HttpServerConfig.java†L72-L77】【F:common/src/main/java/com/clapter/httpautomator/http/handlers/HttpReceiverBlockHandler.java†L98-L131】

### How global parameters are applied

- Each `global_param` entry is loaded into a `GlobalParam` object (name, expected value, and optional `redirect_wrong` URL).【F:forge/src/main/java/com/clapter/httpautomator/platform/config/HttpServerConfig.java†L100-L133】
- When an HTTP Receiver handler processes a request, it first checks global parameters before evaluating per-block settings. Missing parameters or mismatched values trigger a `308` redirect to `redirect_wrong` (if provided), and requests with zero parameters redirect to `global_param_redirect_missing` when configured.【F:common/src/main/java/com/clapter/httpautomator/http/handlers/HttpReceiverBlockHandler.java†L81-L132】

### Example configuration

```toml
# URL to send if every request is missing parameters
global_param_redirect_missing = https://example.org/more-info

# First global parameter set (ID = 1)
global_param.1.name = game
global_param.1.value = scavengerhunt2
# Redirect when "game" is absent or wrong
global_param.1.redirect_wrong = https://example.org/wrong-game

# Second global parameter set (ID = teamA)
global_param.teamA.name = team
global_param.teamA.value = kickstarters
```

With the above file, every POST to an HTTP Receiver endpoint must include `game=scavengerhunt2` and `team=kickstarters`. Requests with no parameters will be redirected to `https://example.org/more-info`, and requests missing one of the parameters (or providing a different value) will be redirected to `https://example.org/wrong-game` when applicable.
